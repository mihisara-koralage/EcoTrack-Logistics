<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EcoTrack Driver Dashboard</title>
    <link rel="stylesheet" href="/css/driver.css" />
    <style>
        /* Driver-specific overrides */
        .header { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); }
        .btn-primary { background: #3498db; }
        .btn-primary:hover { background: #2980b9; }
        .filters button { background: #3498db; }
        .filters button:hover { background: #2980b9; }
        .pagination button.active { background: #3498db; }
        .stat-number { color: #3498db; }

        /* Enhanced Driver Dashboard Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            padding: 2rem 3rem;
            border-radius: 20px 20px 0 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(52, 152, 219, 0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        .header-title {
            color: white;
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-title::before {
            content: 'üöö';
            font-size: 2.5rem;
        }

        .logout-button {
            padding: 0.75rem 1.5rem;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .logout-button:hover {
            background: rgba(192, 57, 43, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
        }

        main {
            padding: 2rem;
        }

        #status {
            margin-bottom: 2rem;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        #status.success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 4px solid #28a745;
            color: #155724;
        }

        #status.error {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-left: 4px solid #dc3545;
            color: #721c24;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 2.5rem;
        }

        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(52, 152, 219, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3498db, #2980b9, #3498db);
            opacity: 0.8;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(52, 152, 219, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-bottom: 1px solid rgba(52, 152, 219, 0.1);
        }

        .card-title {
            margin: 0;
            color: #2c3e50;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .card-icon {
            font-size: 2rem;
            opacity: 0.8;
        }

        .deliveries-list {
            padding: 1.5rem;
        }

        .routes-list {
            padding: 1.5rem;
        }

        .route-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid rgba(52, 152, 219, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .route-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #3498db, #2980b9);
            transition: width 0.3s ease;
            width: 0;
        }

        .route-item:hover::before {
            width: 8px;
        }

        .route-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }

        .route-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .route-id {
            font-size: 1.1rem;
            font-weight: 700;
            color: #3498db;
        }

        .route-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .route-status-active {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .route-status-completed {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
        }

        .route-status-pending {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: white;
        }

        .route-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .route-info-item {
            padding: 0.75rem;
            background: white;
            border-radius: 8px;
            border: 1px solid rgba(52, 152, 219, 0.1);
        }

        .route-info-label {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.25rem;
        }

        .route-info-value {
            font-size: 0.95rem;
            color: #495057;
            font-weight: 500;
        }

        .route-path {
            margin: 1rem 0;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid rgba(52, 152, 219, 0.1);
        }

        .route-path-label {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .route-path-value {
            font-size: 0.95rem;
            color: #495057;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .route-path-value::before {
            content: 'üõ£Ô∏è';
            font-size: 1rem;
        }

        .route-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .route-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .route-btn-primary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .route-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .route-btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
        }

        .route-btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }

        .no-routes {
            text-align: center;
            padding: 3rem;
            color: #6c757d;
            font-style: italic;
        }

        .no-routes::before {
            content: 'üõ£Ô∏è';
            display: block;
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Performance Metrics Styles */
        .performance-metrics {
            padding: 1.5rem;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .performance-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid rgba(52, 152, 219, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .performance-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3498db, #2980b9);
            opacity: 0.8;
        }

        .performance-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }

        .performance-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: #3498db;
            margin-bottom: 0.5rem;
        }

        .performance-label {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .performance-trend {
            font-size: 0.8rem;
            margin-top: 0.5rem;
            font-weight: 600;
        }

        .trend-up {
            color: #28a745;
        }

        .trend-down {
            color: #dc3545;
        }

        /* Quick Actions Styles */
        .quick-actions {
            padding: 1.5rem;
        }

        .quick-action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .quick-action-btn {
            padding: 1rem;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .quick-action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .quick-action-btn:hover::before {
            left: 100%;
        }

        .quick-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
        }

        .quick-action-icon {
            display: block;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .quick-action-text {
            display: block;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Activity Log Styles */
        .activity-log {
            padding: 1.5rem;
        }

        .activity-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid rgba(52, 152, 219, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .activity-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: linear-gradient(135deg, #3498db, #2980b9);
            opacity: 0.8;
        }

        .activity-item:hover {
            transform: translateX(2px);
            box-shadow: 0 2px 10px rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }

        .activity-time {
            font-size: 0.8rem;
            color: #6c757d;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .activity-text {
            font-size: 0.9rem;
            color: #495057;
            font-weight: 500;
        }

        .activity-type {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 0.5rem;
        }

        .activity-delivery {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .activity-route {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .activity-status {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: white;
        }

        /* Weather & Traffic Styles */
        .weather-traffic {
            padding: 1.5rem;
        }

        .weather-traffic-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .weather-card, .traffic-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid rgba(52, 152, 219, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .weather-card:hover, .traffic-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }

        .weather-icon, .traffic-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .weather-temp, .traffic-status {
            font-size: 1.5rem;
            font-weight: 700;
            color: #3498db;
            margin-bottom: 0.5rem;
        }

        .weather-desc, .traffic-desc {
            font-size: 0.9rem;
            color: #6c757d;
            font-weight: 500;
        }

        .weather-details, .traffic-details {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(52, 152, 219, 0.1);
            font-size: 0.85rem;
            color: #495057;
        }

        .weather-detail-item, .traffic-detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.25rem;
        }

        .detail-label {
            font-weight: 600;
            color: #6c757d;
        }

        .detail-value {
            font-weight: 500;
            color: #495057;
        }

        .delivery-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid rgba(52, 152, 219, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .delivery-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #3498db, #2980b9);
            transition: width 0.3s ease;
            width: 0;
        }

        .delivery-item:hover::before {
            width: 8px;
        }

        .delivery-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }

        .delivery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .delivery-id {
            font-size: 1.1rem;
            font-weight: 700;
            color: #3498db;
        }

        .delivery-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: white;
        }

        .status-in-transit {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .status-delivered {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .status-failed {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
        }

        .delivery-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .delivery-info-item {
            padding: 0.75rem;
            background: white;
            border-radius: 8px;
            border: 1px solid rgba(52, 152, 219, 0.1);
        }

        .delivery-info-label {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.25rem;
        }

        .delivery-info-value {
            font-size: 0.95rem;
            color: #495057;
            font-weight: 500;
        }

        .delivery-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .delivery-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .delivery-btn-primary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .delivery-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .delivery-btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
        }

        .delivery-btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }

        .status-summary-grid {
            padding: 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .status-stat {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid rgba(52, 152, 219, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .status-stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }

        .status-stat-number {
            font-size: 2rem;
            font-weight: 800;
            color: #3498db;
            margin-bottom: 0.5rem;
        }

        .status-stat-label {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .no-deliveries {
            text-align: center;
            padding: 3rem;
            color: #6c757d;
            font-style: italic;
        }

        .no-deliveries::before {
            content: 'üì¶';
            display: block;
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                margin: 0.5rem;
            }

            header {
                padding: 1.5rem;
            }

            .header-title {
                font-size: 1.5rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .delivery-info {
                grid-template-columns: 1fr;
            }

            /* Professional Header Styles */
            .header-content {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 1.5rem 2rem;
                background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
                color: white;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

        .logo-section {
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            .logo-icon {
                font-size: 2.5rem;
                background: rgba(255, 255, 255, 0.1);
                padding: 0.5rem;
                border-radius: 12px;
                backdrop-filter: blur(10px);
            }

            .logo-text h1 {
                margin: 0;
                font-size: 1.8rem;
                font-weight: 700;
            }

            .logo-text p {
                margin: 0;
                font-size: 0.9rem;
                opacity: 0.8;
            }

            .header-actions {
                display: flex;
                align-items: center;
                gap: 1.5rem;
            }

            .user-info {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                padding: 0.5rem 1rem;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 25px;
                backdrop-filter: blur(10px);
            }

            .user-avatar {
                width: 35px;
                height: 35px;
                background: rgba(255, 255, 255, 0.3);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: 600;
            }

            .logout-button {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.75rem 1.5rem;
                background: rgba(231, 76, 60, 0.9);
                color: white;
                border: none;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .logout-button:hover {
                background: rgba(192, 57, 43, 0.9);
                transform: translateY(-2px);
            }

            /* Professional Navigation */
            .main-nav {
                display: flex;
                justify-content: center;
                background: rgba(255, 255, 255, 0.05);
                padding: 1rem;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }

            .main-nav a {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.75rem 1.5rem;
                color: black;
                text-decoration: none;
                border-radius: 8px;
                transition: all 0.3s ease;
                font-weight: 500;
            }

            .main-nav a:hover {
                background: rgba(255, 255, 255, 0.1);
                color: black;
            }

            .main-nav a.active {
                background: rgba(255, 255, 255, 0.2);
                color: black;
            }

            .nav-icon {
            font-size: 1.2rem;
        }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-content">
          <div class="logo-section">
            
            <div class="logo-text">
              <h1 class="header-title">EcoTrack Driver</h1>
              <p class="header-subtitle">Professional Delivery Management</p>
            </div>
          </div>
          <div class="header-actions">
            
              
            <button id="logout" class="logout-button">
              Logout
            </button>
          </div>
        </div>
        <nav class="main-nav">
          <a href="/driver-dashboard.html" class="active">
            Dashboard
          </a>
          <a href="/driver-parcels.html">
            My Parcels
          </a>
          <a href="/driver-route.html">
            Current Route
          </a>
          <a href="/driver-profile.html">
            Profile
          </a>
        </nav>
      </header>
    
    <main>
      <section id="status" role="status" aria-live="polite"></section>
      
      <div class="dashboard-grid">
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Assigned Deliveries</h2>
            <div class="card-icon">üì¶</div>
          </div>
          <div class="deliveries-list" id="deliveries">
            <!-- Deliveries will be populated here -->
          </div>
        </section>
        
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">My Routes</h2>
            <div class="card-icon">üõ£Ô∏è</div>
          </div>
          <div class="routes-list" id="routes">
            <!-- Routes will be populated here -->
          </div>
        </section>
        
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Status Summary</h2>
            <div class="card-icon">üìä</div>
          </div>
          <div class="status-summary-grid" id="status-summary">
            <!-- Status summary will be populated here -->
          </div>
        </section>
      </div>

      <div class="dashboard-grid">
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Today's Performance</h2>
            <div class="card-icon">‚ö°</div>
          </div>
          <div class="performance-metrics" id="performance">
            <!-- Performance metrics will be populated here -->
          </div>
        </section>
        
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Quick Actions</h2>
            <div class="card-icon">üöÄ</div>
          </div>
          <div class="quick-actions" id="quick-actions">
            <!-- Quick actions will be populated here -->
          </div>
        </section>
      </div>

      <div class="dashboard-grid">
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Recent Activity</h2>
            <div class="card-icon">üìã</div>
          </div>
          <div class="activity-log" id="activity-log">
            <!-- Activity log will be populated here -->
          </div>
        </section>
        
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Weather & Traffic</h2>
            <div class="card-icon">üå§Ô∏è</div>
          </div>
          <div class="weather-traffic" id="weather-traffic">
            <!-- Weather and traffic info will be populated here -->
          </div>
        </section>
      </div>
    </main>
    <script>
      const statusEl = document.getElementById('status');
      const deliveriesEl = document.getElementById('deliveries');
      const routesEl = document.getElementById('routes');
      const statusSummaryEl = document.getElementById('status-summary');
      const performanceEl = document.getElementById('performance');
      const quickActionsEl = document.getElementById('quick-actions');
      const activityLogEl = document.getElementById('activity-log');
      const weatherTrafficEl = document.getElementById('weather-traffic');
      const logoutButton = document.getElementById('logout');

      const renderStatus = (message, isError = false) => {
        statusEl.textContent = message;
        statusEl.className = isError ? 'error' : 'success';
        
        // Remove animation classes after animation completes
        setTimeout(() => {
          statusEl.className = '';
        }, 3000);
      };

      const renderDeliveries = (deliveries) => {
        if (!deliveries || deliveries.length === 0) {
          deliveriesEl.innerHTML = '<p style="text-align: center; color: #666;">No deliveries assigned</p>';
          return;
        }

        deliveriesEl.innerHTML = deliveries.map(delivery => `
          <div class="delivery-item">
            <div class="delivery-header">
              <span class="delivery-id">${delivery.parcelId || 'N/A'}</span>
              <span class="delivery-status status-${delivery.status?.toLowerCase() || 'pending'}">
                ${delivery.status || 'Pending'}
              </span>
            </div>
            <div class="delivery-details">
              <div class="delivery-address">
                <strong>Address:</strong> ${delivery.deliveryAddress || 'N/A'}
              </div>
              <div class="delivery-customer">
                <strong>Customer:</strong> ${delivery.receiverName || 'N/A'}
              </div>
              <div class="delivery-time">
                <strong>Estimated:</strong> ${delivery.estimatedDelivery || 'Not set'}
              </div>
            </div>
            <div class="action-buttons">
              <button class="btn btn-primary" onclick="updateDeliveryStatus('${delivery.parcelId}', 'InTransit')">
                Start Delivery
              </button>
              <button class="btn btn-success" onclick="updateDeliveryStatus('${delivery.parcelId}', 'Delivered')">
                Mark Delivered
              </button>
            </div>
          </div>
        `).join('');
      };

      const renderStatusSummary = (summary) => {
        if (!summary) {
          statusSummaryEl.innerHTML = '<p style="text-align: center; color: #666;">No data available</p>';
          return;
        }

        statusSummaryEl.innerHTML = `
          <div class="stat-item">
            <div class="stat-value">${summary.total || 0}</div>
            <div class="stat-label">Total Deliveries</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${summary.completed || 0}</div>
            <div class="stat-label">Completed</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${summary.inProgress || 0}</div>
            <div class="stat-label">In Progress</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${summary.pending || 0}</div>
            <div class="stat-label">Pending</div>
          </div>
        `;
      };

      const renderPerformance = (performance) => {
        performanceEl.innerHTML = `
          <div class="performance-grid">
            <div class="performance-item">
              <div class="performance-value">${performance.deliveriesCompleted || 0}</div>
              <div class="performance-label">Deliveries</div>
              <div class="performance-trend trend-up">‚Üë 12%</div>
            </div>
            <div class="performance-item">
              <div class="performance-value">${performance.distanceTraveled || 0}km</div>
              <div class="performance-label">Distance</div>
              <div class="performance-trend trend-up">‚Üë 8%</div>
            </div>
            <div class="performance-item">
              <div class="performance-value">${performance.fuelUsed || 0}L</div>
              <div class="performance-label">Fuel Used</div>
              <div class="performance-trend trend-down">‚Üì 5%</div>
            </div>
            <div class="performance-item">
              <div class="performance-value">${performance.avgTime || 0}min</div>
              <div class="performance-label">Avg Time</div>
              <div class="performance-trend trend-down">‚Üì 3%</div>
            </div>
            <div class="performance-item">
              <div class="performance-value">${performance.onTimeRate || 0}%</div>
              <div class="performance-label">On Time</div>
              <div class="performance-trend trend-up">‚Üë 15%</div>
            </div>
            <div class="performance-item">
              <div class="performance-value">${performance.carbonSaved || 0}kg</div>
              <div class="performance-label">CO‚ÇÇ Saved</div>
              <div class="performance-trend trend-up">‚Üë 20%</div>
            </div>
          </div>
        `;
      };

      const renderQuickActions = (actions) => {
        quickActionsEl.innerHTML = actions.map(action => `
          <button class="quick-action-btn" onclick="${action.id.replace('-', '')}()" ${!action.available ? 'disabled' : ''}>
            <span class="quick-action-icon">${action.icon}</span>
            <span class="quick-action-text">${action.text}</span>
          </button>
        `).join('');
      };

      const renderActivityLog = (activities) => {
        activityLogEl.innerHTML = activities.map(activity => `
          <div class="activity-item">
            <div class="activity-time">${activity.time}</div>
            <div class="activity-text">
              ${activity.text}
              <span class="activity-type activity-${activity.type}">${activity.type}</span>
            </div>
          </div>
        `).join('');
      };

      const renderWeatherTraffic = (weather, traffic) => {
        weatherTrafficEl.innerHTML = `
          <div class="weather-traffic-grid">
            <div class="weather-card">
              <div class="weather-icon">${weather.icon}</div>
              <div class="weather-temp">${weather.temperature}¬∞C</div>
              <div class="weather-desc">${weather.description}</div>
              <div class="weather-details">
                <div class="weather-detail-item">
                  <span class="detail-label">Humidity:</span>
                  <span class="detail-value">${weather.humidity}%</span>
                </div>
                <div class="weather-detail-item">
                  <span class="detail-label">Wind:</span>
                  <span class="detail-value">${weather.windSpeed} km/h</span>
                </div>
                <div class="weather-detail-item">
                  <span class="detail-label">Visibility:</span>
                  <span class="detail-value">${weather.visibility} km</span>
                </div>
              </div>
            </div>
            <div class="traffic-card">
              <div class="traffic-icon">${traffic.icon}</div>
              <div class="traffic-status">${traffic.status}</div>
              <div class="traffic-desc">${traffic.description}</div>
              <div class="traffic-details">
                <div class="traffic-detail-item">
                  <span class="detail-label">Main Route:</span>
                  <span class="detail-value">${traffic.mainRoute}</span>
                </div>
                <div class="traffic-detail-item">
                  <span class="detail-label">Alt Route:</span>
                  <span class="detail-value">${traffic.altRoute}</span>
                </div>
                <div class="traffic-detail-item">
                  <span class="detail-label">Delay:</span>
                  <span class="detail-value">${traffic.delay} min</span>
                </div>
              </div>
            </div>
          </div>
        `;
      };

      // Quick action functions
      const startNewDelivery = () => {
        renderStatus('Starting new delivery workflow...', false);
      };

      const reportIssue = () => {
        renderStatus('Opening issue reporting form...', false);
      };

      const requestBreak = () => {
        renderStatus('Sending break request to supervisor...', false);
      };

      const emergencyContact = () => {
        renderStatus('Connecting to emergency support...', false);
      };

      const viewMap = () => {
        renderStatus('Opening interactive map view...', false);
      };

      const fuelStation = () => {
        renderStatus('Finding nearest fuel stations...', false);
      };

      const customercall = () => {
        renderStatus('Opening customer contact interface...', false);
      };

      const scanpackage = () => {
        renderStatus('Opening package scanner...', false);
      };

      const renderRoutes = (routes) => {
        if (!routes || routes.length === 0) {
          routesEl.innerHTML = '<div class="no-routes">No routes assigned</div>';
          return;
        }

        routesEl.innerHTML = routes.map(route => `
          <div class="route-item">
            <div class="route-header">
              <span class="route-id">${route.routeId || 'N/A'}</span>
              <span class="route-status route-status-${route.status?.toLowerCase() || 'pending'}">
                ${route.status || 'Pending'}
              </span>
            </div>
            <div class="route-info">
              <div class="route-info-item">
                <div class="route-info-label">Distance</div>
                <div class="route-info-value">${route.distanceKm || 'N/A'} km</div>
              </div>
              <div class="route-info-item">
                <div class="route-info-label">Est. Time</div>
                <div class="route-info-value">${route.estimatedTimeMinutes || 'N/A'} min</div>
              </div>
              <div class="route-info-item">
                <div class="route-info-label">Fuel</div>
                <div class="route-info-value">${route.fuelConsumptionL || 'N/A'} L</div>
              </div>
              <div class="route-info-item">
                <div class="route-info-label">Carbon</div>
                <div class="route-info-value">${route.carbonFootprintKg || 'N/A'} kg CO‚ÇÇ</div>
              </div>
            </div>
            <div class="route-path">
              <div class="route-path-label">Route Path</div>
              <div class="route-path-value">${route.pickupLocation || 'N/A'} ‚Üí ${route.deliveryLocation || 'N/A'}</div>
            </div>
            <div class="route-actions">
              <button class="route-btn route-btn-primary" onclick="startRoute('${route.routeId}')">Start Route</button>
              <button class="route-btn route-btn-secondary" onclick="viewRouteDetails('${route.routeId}')">View Details</button>
            </div>
          </div>
        `).join('');
      };

      const updateDeliveryStatus = async (deliveryId, status) => {
        try {
          renderStatus(`Updating delivery status to ${status}...`);
          
          // For demo purposes, we'll simulate the update since we don't have real parcels
          // In a real system, this would call the actual parcel API
          const response = await fetch(`/api/parcels/${deliveryId}/status`, {
            method: 'PATCH',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({ status })
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.message || 'Failed to update status');
          }

          renderStatus(`Delivery status updated to ${status}`);
          loadDriverData(); // Reload data
          
        } catch (error) {
          // If the parcel doesn't exist (which is likely with mock data), show a user-friendly message
          if (error.message.includes('not found') || error.message.includes('404')) {
            renderStatus('This is a demo - status updates would work with real parcels', false);
          } else {
            renderStatus(`Error updating status: ${error.message}`, true);
          }
        }
      };

      const startRoute = async (routeId) => {
        try {
          renderStatus('Starting route...');
          
          // In a real system, this would call the route API
          const response = await fetch(`/api/routes/${routeId}/start`, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });

          if (!response.ok) {
            throw new Error('Failed to start route');
          }

          renderStatus('Route started successfully');
          loadDriverData(); // Reload data
          
        } catch (error) {
          renderStatus('This is a demo - route starting would work with real routes', false);
        }
      };

      const viewRouteDetails = (routeId) => {
        // In a real system, this would open a detailed route view
        renderStatus(`Viewing details for route ${routeId} - Map view would open here`, false);
      };

      const loadDriverData = async () => {
        try {
          renderStatus('Loading driver data...');
          
          // Mock driver dashboard data for frontend-only setup
          setTimeout(() => {
            const mockData = getMockDriverData();
            console.log('Mock data loaded:', mockData); // Debug log
            renderStatus('Driver dashboard loaded successfully.');
            
            // Render deliveries
            if (mockData.assignedDeliveries && mockData.assignedDeliveries.length > 0) {
              console.log('Rendering deliveries:', mockData.assignedDeliveries.length); // Debug log
              deliveriesEl.innerHTML = mockData.assignedDeliveries.map(delivery => {
                // Determine next possible status based on current status
                let nextStatus = '';
                let nextButtonLabel = '';
                
                switch (delivery.status) {
                  case 'PickedUp':
                    nextStatus = 'InTransit';
                    nextButtonLabel = 'Start Delivery';
                    break;
                  case 'InTransit':
                    nextStatus = 'Delivered';
                    nextButtonLabel = 'Mark as Delivered';
                    break;
                  default:
                    nextStatus = 'PickedUp';
                    nextButtonLabel = 'Mark as Picked Up';
                }
                
                return `
                  <div class="delivery-card">
                    <div class="delivery-header">
                      <span class="delivery-id">${delivery.parcelId}</span>
                      <span class="delivery-status status-${delivery.status}">${delivery.status}</span>
                    </div>
                    <div class="delivery-route">
                      <span class="route-icon">Route</span>
                      <span>${delivery.pickupLocation} ‚Üí ${delivery.deliveryLocation}</span>
                    </div>
                    <div class="delivery-details">
                      <span class="customer-icon">Customer</span>
                      <span>${delivery.customerName}</span>
                      <span class="phone-icon">Phone</span>
                      <span>${delivery.customerPhone}</span>
                    </div>
                    <div class="delivery-info">
                      <div class="info-item">
                        <span class="info-label">Weight:</span>
                        <span class="info-value">${delivery.packageWeight}</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Type:</span>
                        <span class="info-value">${delivery.packageType}</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Time:</span>
                        <span class="info-value">${delivery.estimatedTime}</span>
                      </div>
                    </div>
                    <div class="delivery-actions">
                      <button class="action-btn" onclick="updateDeliveryStatus('${delivery.parcelId}', '${nextStatus}')">
                        ${nextButtonLabel}
                      </button>
                      <button class="action-btn secondary" onclick="viewDeliveryDetails('${delivery.parcelId}')">
                        View Details
                      </button>
                    </div>
                  </div>
                `;
              }).join('');
            } else {
              deliveriesEl.innerHTML = '<div class="no-deliveries">No deliveries assigned</div>';
            }
            
            // Stats are displayed in the status summary section above
            
            // Render status summary
            if (mockData.stats) {
              statusSummaryEl.innerHTML = `
                <div class="stat-item">
                  <div class="stat-value">${mockData.stats.todayCompleted || 0}</div>
                  <div class="stat-label">Completed Today</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value">${mockData.stats.inTransitDeliveries || 0}</div>
                  <div class="stat-label">In Transit</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value">${mockData.stats.todayPending || 0}</div>
                  <div class="stat-label">Pending</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value">${mockData.stats.onTimeDeliveryRate || 0}%</div>
                  <div class="stat-label">On-Time Rate</div>
                </div>
              `;
            }
            
            // Render routes
            if (mockData.routes && mockData.routes.length > 0) {
              console.log('Rendering routes:', mockData.routes.length); // Debug log
              renderRoutes(mockData.routes);
            } else {
              // Fallback content
              routesEl.innerHTML = `
                <div class="route-item">
                  <div class="route-header">
                    <span class="route-id">ROUTE-001</span>
                    <span class="route-status route-status-active">Active</span>
                  </div>
                  <div class="route-info">
                    <div class="route-info-item">
                      <div class="route-info-label">Distance</div>
                      <div class="route-info-value">12.5 km</div>
                    </div>
                    <div class="route-info-item">
                      <div class="route-info-label">Est. Time</div>
                      <div class="route-info-value">25 min</div>
                    </div>
                  </div>
                  <div class="route-path">
                    <div class="route-path-label">Route Path</div>
                    <div class="route-path-value">Colombo ‚Üí Kandy</div>
                  </div>
                </div>
              `;
            }
            
            // Render performance metrics
            if (mockData.performance) {
              console.log('Rendering performance metrics'); // Debug log
              renderPerformance(mockData.performance);
            } else {
              // Fallback content
              performanceEl.innerHTML = `
                <div class="performance-grid">
                  <div class="performance-item">
                    <div class="performance-value">18</div>
                    <div class="performance-label">Deliveries</div>
                    <div class="performance-trend trend-up">‚Üë 12%</div>
                  </div>
                  <div class="performance-item">
                    <div class="performance-value">156.8km</div>
                    <div class="performance-label">Distance</div>
                    <div class="performance-trend trend-up">‚Üë 8%</div>
                  </div>
                  <div class="performance-item">
                    <div class="performance-value">28.4L</div>
                    <div class="performance-label">Fuel Used</div>
                    <div class="performance-trend trend-down">‚Üì 5%</div>
                  </div>
                  <div class="performance-item">
                    <div class="performance-value">28min</div>
                    <div class="performance-label">Avg Time</div>
                    <div class="performance-trend trend-down">‚Üì 3%</div>
                  </div>
                  <div class="performance-item">
                    <div class="performance-value">94%</div>
                    <div class="performance-label">On Time</div>
                    <div class="performance-trend trend-up">‚Üë 15%</div>
                  </div>
                  <div class="performance-item">
                    <div class="performance-value">45.2kg</div>
                    <div class="performance-label">CO‚ÇÇ Saved</div>
                    <div class="performance-trend trend-up">‚Üë 20%</div>
                  </div>
                </div>
              `;
            }
            
            // Render quick actions
            if (mockData.quickActions) {
              console.log('Rendering quick actions:', mockData.quickActions.length); // Debug log
              renderQuickActions(mockData.quickActions);
            } else {
              // Fallback content
              quickActionsEl.innerHTML = `
                <button class="quick-action-btn" onclick="startNewDelivery()">
                  <span class="quick-action-icon">üì¶</span>
                  <span class="quick-action-text">Start New Delivery</span>
                </button>
                <button class="quick-action-btn" onclick="reportIssue()">
                  <span class="quick-action-icon">‚ö†Ô∏è</span>
                  <span class="quick-action-text">Report Issue</span>
                </button>
                <button class="quick-action-btn" onclick="requestBreak()">
                  <span class="quick-action-icon">‚òï</span>
                  <span class="quick-action-text">Take Break</span>
                </button>
                <button class="quick-action-btn" onclick="emergencyContact()">
                  <span class="quick-action-icon">üìû</span>
                  <span class="quick-action-text">Emergency Contact</span>
                </button>
                <button class="quick-action-btn" onclick="viewMap()">
                  <span class="quick-action-icon">üó∫Ô∏è</span>
                  <span class="quick-action-text">View Map</span>
                </button>
                <button class="quick-action-btn" onclick="fuelStation()">
                  <span class="quick-action-icon">‚õΩ</span>
                  <span class="quick-action-text">Find Fuel</span>
                </button>
              `;
            }
            
            // Render activity log
            if (mockData.activities) {
              console.log('Rendering activities:', mockData.activities.length); // Debug log
              renderActivityLog(mockData.activities);
            } else {
              // Fallback content
              activityLogEl.innerHTML = `
                <div class="activity-item">
                  <div class="activity-time">11:30 AM</div>
                  <div class="activity-text">
                    Delivered PKG-2024-004 to Polonnaruwa
                    <span class="activity-type activity-delivery">delivery</span>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-time">10:45 AM</div>
                  <div class="activity-text">
                    Started delivery of PKG-2024-003
                    <span class="activity-type activity-status">status</span>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-time">10:15 AM</div>
                  <div class="activity-text">
                    Picked up PKG-2024-003 from Jaffna
                    <span class="activity-type activity-pickup">pickup</span>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-time">09:30 AM</div>
                  <div class="activity-text">
                    Started route ROUTE-001
                    <span class="activity-type activity-route">route</span>
                  </div>
                </div>
                <div class="activity-item">
                  <div class="activity-time">09:15 AM</div>
                  <div class="activity-text">
                    Vehicle check completed - all systems OK
                    <span class="activity-type activity-status">status</span>
                  </div>
                </div>
              `;
            }
            
            // Render weather and traffic
            if (mockData.weather && mockData.traffic) {
              console.log('Rendering weather and traffic'); // Debug log
              renderWeatherTraffic(mockData.weather, mockData.traffic);
            } else {
              // Fallback content
              weatherTrafficEl.innerHTML = `
                <div class="weather-traffic-grid">
                  <div class="weather-card">
                    <div class="weather-icon">Sunny</div>
                    <div class="weather-temp">28¬∞C</div>
                    <div class="weather-desc">Sunny with clear skies</div>
                    <div class="weather-details">
                      <div class="weather-detail-item">
                        <span class="detail-label">Humidity:</span>
                        <span class="detail-value">65%</span>
                      </div>
                      <div class="weather-detail-item">
                        <span class="detail-label">Wind:</span>
                        <span class="detail-value">12 km/h</span>
                      </div>
                      <div class="weather-detail-item">
                        <span class="detail-label">Visibility:</span>
                        <span class="detail-value">10 km</span>
                      </div>
                    </div>
                  </div>
                  <div class="traffic-card">
                    <div class="traffic-icon">Traffic</div>
                    <div class="traffic-status">Moderate</div>
                    <div class="traffic-desc">Normal traffic flow expected</div>
                    <div class="traffic-details">
                      <div class="traffic-detail-item">
                        <span class="detail-label">Main Route:</span>
                        <span class="detail-value">Clear - 5 min delay</span>
                      </div>
                      <div class="traffic-detail-item">
                        <span class="detail-label">Alt Route:</span>
                        <span class="detail-value">Available - 2 min faster</span>
                      </div>
                      <div class="traffic-detail-item">
                        <span class="detail-label">Delay:</span>
                        <span class="detail-value">5 min</span>
                      </div>
                    </div>
                  </div>
                </div>
              `;
            }
            
          }, 1000);
          
        } catch (error) {
          console.error('Error loading driver data:', error);
          renderStatus('Error loading driver data', true);
        }
      };

      // Mock driver dashboard data function
      const getMockDriverData = () => {
        return {
          assignedDeliveries: [
            {
              parcelId: 'PKG-2024-001',
              status: 'Pending',
              pickupLocation: 'Colombo',
              deliveryLocation: 'Kandy',
              customerName: 'John Smith',
              customerPhone: '+94 77 123 4567',
              priority: 'Normal',
              estimatedTime: '2 hours',
              pickupAddress: '123 Main St, Colombo',
              deliveryAddress: '456 Queen St, Kandy',
              packageWeight: '2.5 kg',
              packageType: 'Standard',
              specialInstructions: 'Handle with care - fragile items'
            },
            {
              parcelId: 'PKG-2024-002',
              status: 'PickedUp',
              pickupLocation: 'Galle',
              deliveryLocation: 'Matara',
              customerName: 'Sarah Johnson',
              customerPhone: '+94 77 234 5678',
              priority: 'High',
              estimatedTime: '1 hour',
              pickupAddress: '789 Beach Rd, Galle',
              deliveryAddress: '321 Market St, Matara',
              packageWeight: '1.2 kg',
              packageType: 'Express',
              specialInstructions: 'Urgent delivery - medical supplies'
            },
            {
              parcelId: 'PKG-2024-003',
              status: 'InTransit',
              pickupLocation: 'Jaffna',
              deliveryLocation: 'Trincomalee',
              customerName: 'Michael Brown',
              customerPhone: '+94 77 345 6789',
              priority: 'Normal',
              estimatedTime: '3 hours',
              pickupAddress: '555 Temple St, Jaffna',
              deliveryAddress: '777 Harbor Rd, Trincomalee',
              packageWeight: '5.8 kg',
              packageType: 'Large',
              specialInstructions: 'Heavy package - use hand truck'
            },
            {
              parcelId: 'PKG-2024-004',
              status: 'Delivered',
              pickupLocation: 'Anuradhapura',
              deliveryLocation: 'Polonnaruwa',
              customerName: 'Emma Wilson',
              customerPhone: '+94 77 456 7890',
              priority: 'Low',
              estimatedTime: '2.5 hours',
              pickupAddress: '999 Ancient City Rd, Anuradhapura',
              deliveryAddress: '888 Heritage Ave, Polonnaruwa',
              packageWeight: '0.8 kg',
              packageType: 'Document',
              specialInstructions: 'Confidential documents'
            },
            {
              parcelId: 'PKG-2024-005',
              status: 'Pending',
              pickupLocation: 'Negombo',
              deliveryLocation: 'Puttalam',
              customerName: 'David Lee',
              customerPhone: '+94 77 567 8901',
              priority: 'Normal',
              estimatedTime: '1.5 hours',
              pickupAddress: '222 Fisherman St, Negombo',
              deliveryAddress: '444 Coastal Rd, Puttalam',
              packageWeight: '3.2 kg',
              packageType: 'Standard',
              specialInstructions: 'Perishable items - deliver ASAP'
            }
          ],
          stats: {
            totalDeliveries: 25,
            completedDeliveries: 18,
            pendingDeliveries: 5,
            inTransitDeliveries: 2,
            todayCompleted: 8,
            todayPending: 3,
            averageDeliveryTime: 28,
            onTimeDeliveryRate: 94
          },
          routes: [
            {
              routeId: 'ROUTE-001',
              status: 'Active',
              distanceKm: 12.5,
              estimatedTimeMinutes: 25,
              fuelConsumptionL: 2.1,
              carbonFootprintKg: 3.2,
              pickupLocation: 'Colombo',
              deliveryLocation: 'Kandy',
              waypoints: ['Nugegoda', 'Kaduwela', 'Kegalle'],
              trafficCondition: 'Moderate',
              weatherCondition: 'Clear',
              priority: 'High'
            },
            {
              routeId: 'ROUTE-002',
              status: 'Pending',
              distanceKm: 18.7,
              estimatedTimeMinutes: 35,
              fuelConsumptionL: 3.2,
              carbonFootprintKg: 4.8,
              pickupLocation: 'Galle',
              deliveryLocation: 'Matara',
              waypoints: ['Ambalangoda', 'Hikkaduwa'],
              trafficCondition: 'Heavy',
              weatherCondition: 'Light Rain',
              priority: 'Normal'
            },
            {
              routeId: 'ROUTE-003',
              status: 'Completed',
              distanceKm: 8.3,
              estimatedTimeMinutes: 15,
              fuelConsumptionL: 1.4,
              carbonFootprintKg: 2.1,
              pickupLocation: 'Negombo',
              deliveryLocation: 'Puttalam',
              waypoints: ['Marawila', 'Chilaw'],
              trafficCondition: 'Light',
              weatherCondition: 'Sunny',
              priority: 'Low'
            },
            {
              routeId: 'ROUTE-004',
              status: 'Planned',
              distanceKm: 22.1,
              estimatedTimeMinutes: 40,
              fuelConsumptionL: 3.8,
              carbonFootprintKg: 5.6,
              pickupLocation: 'Jaffna',
              deliveryLocation: 'Vavuniya',
              waypoints: ['Kilinochchi', 'Elephant Pass'],
              trafficCondition: 'Moderate',
              weatherCondition: 'Cloudy',
              priority: 'Normal'
            }
          ],
          performance: {
            deliveriesCompleted: 18,
            distanceTraveled: 156.8,
            fuelUsed: 28.4,
            avgTime: 28,
            onTimeRate: 94,
            carbonSaved: 45.2,
            customerRating: 4.8,
            efficiency: 87,
            earnings: 12500
          },
          activities: [
            { time: '11:30 AM', text: 'Delivered PKG-2024-004 to Polonnaruwa', type: 'delivery' },
            { time: '10:45 AM', text: 'Started delivery of PKG-2024-003', type: 'status' },
            { time: '10:15 AM', text: 'Picked up PKG-2024-003 from Jaffna', type: 'pickup' },
            { time: '09:30 AM', text: 'Started route ROUTE-001', type: 'route' },
            { time: '09:15 AM', text: 'Vehicle check completed - all systems OK', type: 'status' },
            { time: '09:00 AM', text: 'Received daily assignments from supervisor', type: 'assignment' },
            { time: '08:45 AM', text: 'Loaded 5 parcels into vehicle', type: 'status' },
            { time: '08:30 AM', text: 'Shift started - logged into system', type: 'status' },
            { time: '08:15 AM', text: 'Vehicle inspection completed', type: 'inspection' },
            { time: '08:00 AM', text: 'Arrived at distribution center', type: 'arrival' }
          ],
          weather: {
            icon: '‚òÄÔ∏è',
            temperature: 28,
            description: 'Sunny with clear skies',
            humidity: 65,
            windSpeed: 12,
            visibility: 10,
            uvIndex: 7,
            feelsLike: 30,
            precipitation: 0
          },
          traffic: {
            icon: 'üöó',
            status: 'Moderate',
            description: 'Normal traffic flow expected',
            mainRoute: 'Clear - 5 min delay',
            altRoute: 'Available - 2 min faster',
            delay: 5,
            congestionLevel: 'Medium',
            incidents: 'None reported'
          },
          quickActions: [
            { id: 'start-delivery', icon: 'üì¶', text: 'Start New Delivery', available: true },
            { id: 'report-issue', icon: '‚ö†Ô∏è', text: 'Report Issue', available: true },
            { id: 'take-break', icon: '‚òï', text: 'Take Break', available: true },
            { id: 'emergency', icon: 'üìû', text: 'Emergency Contact', available: true },
            { id: 'view-map', icon: 'üó∫Ô∏è', text: 'View Map', available: true },
            { id: 'fuel-station', icon: '‚õΩ', text: 'Find Fuel', available: true },
            { id: 'customer-call', icon: 'üìû', text: 'Call Customer', available: true },
            { id: 'scan-package', icon: 'üì±', text: 'Scan Package', available: true }
          ],
          vehicleInfo: {
            plateNumber: 'WP-CA-1234',
            make: 'Toyota',
            model: 'HiAce',
            year: 2022,
            fuelLevel: 75,
            mileage: 45230,
            lastService: '2024-01-05',
            nextService: '2024-02-05',
            status: 'Operational'
          }
        };
      };

      const expectedRole = 'Driver';
      const token = localStorage.getItem('ecotrack_token');
      const storedUserRaw = localStorage.getItem('ecotrack_user');
      const storedUser = storedUserRaw ? JSON.parse(storedUserRaw) : null;

      const clearData = () => {
        deliveriesEl.innerHTML = '<p style="text-align: center; color: #666;">No deliveries assigned</p>';
        routesEl.innerHTML = '<div class="no-routes">No routes assigned</div>';
        statusSummaryEl.innerHTML = '<p style="text-align: center; color: #666;">No data available</p>';
        performanceEl.innerHTML = '<p style="text-align: center; color: #666;">No performance data</p>';
        quickActionsEl.innerHTML = '<p style="text-align: center; color: #666;">No actions available</p>';
        activityLogEl.innerHTML = '<p style="text-align: center; color: #666;">No recent activity</p>';
        weatherTrafficEl.innerHTML = '<p style="text-align: center; color: #666;">No weather/traffic data</p>';
      };

      if (!token || !storedUser) {
        renderStatus('Not authenticated. Redirecting to login...', true);
        clearData();
        setTimeout(() => {
          window.location.href = '/login.html';
        }, 1200);
      } else if (storedUser.role !== expectedRole) {
        renderStatus('Access denied for your role.', true);
        clearData();
        setTimeout(() => {
          window.location.href = '/login.html';
        }, 1200);
      } else {
        // Load driver data on page load
        loadDriverData();
        
        // Refresh data every 30 seconds
        setInterval(loadDriverData, 30000);
      }

      logoutButton.addEventListener('click', () => {
        localStorage.removeItem('ecotrack_token');
        localStorage.removeItem('ecotrack_user');
        renderStatus('Logged out. Redirecting to login...');
        clearData();
        setTimeout(() => {
          window.location.href = '/login.html';
        }, 1000);
      });
    </script>
  </body>
</html>
